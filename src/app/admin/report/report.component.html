<nb-card>
	<nb-card-body>
		<div class="titleWrap">
			<label>Reports</label>
		</div>
		<p-tabView (onChange)="getReportData($event)">
			<p-tabPanel header="Admission Request">
				<h3>Note : All applications.</h3>
				<div class="row">
					<div class="col-lg-6 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
							<button mat-button *ngIf="filterText" matSuffix mat-icon-button aria-label="Clear" (click)="filterText=''">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>
					</div>
					<div class="col-lg-3 ">
						<mat-form-field>
							<mat-select placeholder="select Year"[(ngModel)]="selectedYear" name="selectedYear" id="yearCtrl"  (ngModelChange)="filterYearWise($event)" >
								<mat-option value="2017">2017-2018</mat-option>
								<mat-option value="2018">2018-2019</mat-option>
								<mat-option value="2019">2019-2020</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total admissions requested: {{application_data?.length}}</h5></b></tr>
						<tr>
							<th>Application Date</th>
							<th>Student Name</th>
							<th>Student City</th>
							<th>Student Country</th>
							<th>Degree</th>
							<th>Course</th>
							<th>Specialization</th>
							<th>Institute Name</th>
							<th>Intake</th>
							<th>Course Duration</th>
							<th>Fees</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let application of application_data | filter:{application_date: filterText, student_name: filterText, student_city: filterText, country_name: filterText,degree: filterText,
							course_name: filterText,specialization: filterText,college_name: filterText,duration: filterText,fees: filterText} | paginate: { itemsPerPage: 10, currentPage: p1 ,id:'1'} ">
							<td>{{application?.application_date}}</td>
							<td>{{application?.student_name}}</td>
							<td>{{application?.student_city}}</td>
							<td>{{application?.country_name}}</td>
							<td>{{application?.degree}}</td>
							<td>{{application?.course_name}}</td>
							<td>{{application?.specialization}}</td>
							<td>{{application?.college_name}}</td>
							<div *ngIf="application?.intake_date == null">
								<td>-</td>
							</div>
							<div *ngIf="application?.intake_date != null">
								<td>{{application?.intake_date}}/{{application?.intake_month}}/{{application?.intake_year}} To {{application?.intake_to_date}}/{{application?.intake_to_month}}/{{application?.intake_to_year}}</td>
							</div>
							
							<td>{{application?.duration}}</td>
							<td>{{application?.fees}}</td>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p1 = $event" id='1'></pagination-controls>			
			</p-tabPanel>
			<p-tabPanel header="Admission Acceptance">
				<h3>Note : All accepted applications with payment done.</h3>
				<div class="row">
					<div class="col-lg-6 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
							<button mat-button *ngIf="filterText" matSuffix mat-icon-button aria-label="Clear" (click)="filterText=''">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>
					</div>
					<div class="col-lg-3 ">
						<mat-form-field>
							<mat-select placeholder="select Year"[(ngModel)]="selectedYear" name="selectedYear" id="yearCtrl"  (ngModelChange)="filterYearWise($event)" >
								<mat-option value="2017">2017-2018</mat-option>
								<mat-option value="2018">2018-2019</mat-option>
								<mat-option value="2019">2019-2020</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total admissions accepted: {{application_data?.length}}</h5></b></tr>
						<tr>
							<th>Application Date</th>
							<th>Student Name</th>
							<th>Student City</th>
							<th>Student Country</th>
							<th>Degree</th>
							<th>Course</th>
							<th>Specialization</th>
							<th>Institute Name</th>
							<th>Mode of Pay</th>
							<th>Intake</th>
							<th>Course Duration</th>
							<th>Fees</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let application of application_data | filter:{application_date: filterText, student_name: filterText, student_city: filterText, country_name: filterText,degree: filterText,
							course_name: filterText,specialization: filterText,college_name: filterText,duration: filterText,fees: filterText} | paginate: { itemsPerPage: 10, currentPage: p2, id:'2' } ">
							<td>{{application?.application_date}}</td>
							<td>{{application?.student_name}}</td>
							<td>{{application?.student_city}}</td>
							<td>{{application?.country_name}}</td>
							<td>{{application?.degree}}</td>
							<td>{{application?.course_name}}</td>
							<td>{{application?.specialization}}</td>
							<td>{{application?.college_name}}</td>
							<td>{{application?.payment_mode}}</td>
							<div *ngIf="application?.intake_date == null">
								<td>-</td>
							</div>
							<div *ngIf="application?.intake_date != null">
								<td>{{application?.intake_date}}/{{application?.intake_month}}/{{application?.intake_year}} To {{application?.intake_to_date}}/{{application?.intake_to_month}}/{{application?.intake_to_year}}</td>
							</div>
							
							<td>{{application?.duration}}</td>
							<td>{{application?.fees}}</td>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p2 = $event" id='2'></pagination-controls>			
			</p-tabPanel>
			<p-tabPanel header="Application">
				<h3>Applications Requested</h3>
				<div class="row">
					<div class="col-lg-6 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
							<button mat-button *ngIf="filterText" matSuffix mat-icon-button aria-label="Clear" (click)="filterText=''">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>
					</div>
					<div class="col-lg-3 ">
						<mat-form-field>
							<mat-select placeholder="select Year"[(ngModel)]="selectedYear" name="selectedYear" id="yearCtrl"  (ngModelChange)="filterYear('app','new',$event)" >
								<mat-option value="2017">2017-2018</mat-option>
								<mat-option value="2018">2018-2019</mat-option>
								<mat-option value="2019">2019-2020</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto" >
					<thead>
						<h5><b>Total Count:</b></h5>{{application_data?.length}}
						<tr>
							<th>Date</th>
							<th>Application No.</th>
							<th>Application No.For 1st Payment</th>
							<th>Category</th>
							<th>Country Name</th>
							<th>Student Name</th>
							<th>Email Address</th>
							<th>Selected Course</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let application of application_data | filter:{date:filterText,email:filterText,course:filterText,specialization:filterText,student_category:filterText,enrollment_no: filterText,stu_name : filterText,country_name:filterText,user_id:filterText} : false | paginate: { itemsPerPage: 10, currentPage: p3, id:'3' } ">
							<th scope="row">{{application?.date}}</th>
							<td>{{application?.enrollment_no}}</td>
							<td>{{application?.user_id}}</td>
							<td>{{application?.student_category}}</td>
							<td>{{application?.country_name}}</td>
							<td>{{application?.stu_name}}</td>
							<td>{{application?.email}}</td>
							<td>{{application?.specialization}} ({{application?.course}})</td>							
							<td><i class="fa ion-person" status="danger" nbPopover="View More" nbPopoverMode="hover" (click)="viewMore('application',application.user_id,application.course_id,'new',application.id);"></i></td>					
						</tr>
					</tbody>				
				</table>
			<pagination-controls (pageChange)="p3 = $event" id='3'></pagination-controls>			
			</p-tabPanel>
			<p-tabPanel header="Eligibility">
				<b><h3>Eligibility Applications</h3></b><br>
				<div class="row">
					<div class="col-lg-6 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
						</mat-form-field>
					</div>
					<div class="col-lg-3 ">
						<mat-form-field>
							<mat-select placeholder="select Year"[(ngModel)]="selectedYear" name="selectedYear" id="yearCtrl"  (ngModelChange)="filterYear('eligib','new',$event)" >
								<mat-option value="2017">2017-2018</mat-option>
								<mat-option value="2018">2018-2019</mat-option>
								<mat-option value="2019">2019-2020</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>
				
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total Count:{{application_data?.length}}</h5></b></tr>
						<tr>
							<th>Application Id</th>
							<th>Student Name</th>
							<th>Email Address</th>
							<th>Selected Course</th>
							<th>Forword Letter</th>
							<th>Provisional Letter</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let application of application_data | filter:{stu_name: filterText, email: filterText, specialization: filterText, course: filterText} | paginate: { itemsPerPage: 10, currentPage: p4, id :'4' }">
							<td>{{application?.id}}</td>
							<td>{{application?.stu_name}}</td>
							<td>{{application?.email}}</td>
							<td>{{application?.specialization}} ({{application?.course}})</td>
							<td><a (click)=downloadForewordLetter(application.pdf,application.file_name)><img src="https://mu.admissiondesk.org/uiserver/front_assets/img/pdf1.png"  style="height:50px; width:50px;"></a></td>
							<td><img src="https://mu.admissiondesk.org/uiserver/front_assets/img/pdf1.png"  style="height:50px; width:50px;" (click)="DownloadProvisionalLetter(application.user_id,application.id)"></td>
							<td>
								<i class="fa ion-person" id='view_eligibility{{application.id}}' status="danger" nbPopover="View More" nbPopoverMode="hover" (click)="viewMore('eligibility',application.user_id,application.course_id,'new',application.id);"></i>					
							</td>							
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p4 = $event" id='4'></pagination-controls>
			</p-tabPanel>
			<p-tabPanel header="Email Activity">
				<div [nbSpinner]="loadingbutton" nbSpinnerStatus="primary">
					<h3>Email Activity</h3>
					<div class="row">
						<div class="col-md-8">
							<mat-form-field class="example-full-width">
								<input matInput  type="text" [value]="filterText"
								[placeholder]="filterPlaceholder" [formControl]="filterInput" />
								<button mat-button *ngIf="filterText" matSuffix mat-icon-button aria-label="Clear" (click)="filterText=''">
									<mat-icon>close</mat-icon>
								</button>
							</mat-form-field>
						</div>
						<div class="col-md-4">
							<button nbButton outline status="primary" (click)="downloadEmailExcel()">Email Tracker Excel</button>
						</div>
					</div>
					<table class="table table-striped w-auto">
						<thead>
							<h5><b>Total Count:</b></h5>{{emailActivityData?.length}}
							<tr>
								<th>Email ID</th>
								<th>Subject</th>
								<th>Status</th>
								<th>Open Count</th>
								<th>Click Count</th>
								<th>Last-Event-Time</th>
							</tr>
						</thead>
						<tbody>
							<tr class="info" *ngFor="let email of emailActivityData | filter:{to_email:filterText,subject:filterText,status:filterText,opens_count:filterText,clicks_count:filterText,last_event_time:filterText} | paginate: { itemsPerPage: 10, currentPage: p5 , id :'5' }">
								<td>{{email.to_email}}</td>
								<td>{{email.subject}}</td>
								<td>{{email.status}}</td>
								<td>{{email.opens_count}}</td>
								<td>{{email.clicks_count}}</td>
								<td>{{email.last_event_time}}</td>
							</tr>
						</tbody>	
					</table>
					<pagination-controls (pageChange)="p5 = $event" id='5'></pagination-controls>	
				</div>
			</p-tabPanel>
			<p-tabPanel header="Student Statistics">
				<h3>Note : Total microsite visits.</h3>
				<div class="col-xs-12">
					<div class="col-xs-8">
					</div>
					<div class="col-xs-4">
						
					</div>
				</div>
				<div class="row">
					<div class="col-md-12 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total institutes:{{tableData?.length}}</h5></b></tr>
						<tr>
							<th>Institute Name</th>
							<th>National Students</th>
							<th>International Students</th>
							<th>Total</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let data of tableData | paginate: { itemsPerPage: 10, currentPage: p6, id:'6' } | filter : {college_name : filterText} ">
							<td>{{data?.college_name}}</td>
							<td>{{data?.national_visits}}</td>
							<td>{{data?.international_visits}}</td>
							<td>{{data?.national_visits + data?.international_visits}}</td>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p6 = $event" id='6'></pagination-controls>
			</p-tabPanel>
			<p-tabPanel header="Activity Tracker">
				<h3>Note : All Activity.</h3>
				<div class="row">
					<div class="col-md-12 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr>
							<th>Date</th>
							<th>Username</th>
							<th>Action</th>
							<th>DATA</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let activity of activity_data | paginate: { itemsPerPage: 10, currentPage: p7 , id:'7' } | filter:{created_at: filterText, username:filterText, action:filterText, data:filterText }  ">
							<td>{{activity?.created_at}}</td>
							<td>{{activity?.username}}</td>
							<td>{{activity?.action}}</td>
							<td>{{activity?.data}}</td>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p7 = $event" id = '7'></pagination-controls>
			</p-tabPanel>
			<p-tabPanel header="First Challan">
				<h3>First Payment Challan Details</h3>
				<div class="row">
					<div class="col-lg-6 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
						</mat-form-field>
					</div>
					<div class="col-lg-3 ">
						<mat-form-field>
							<mat-select placeholder="select Year"[(ngModel)]="selectedYear" name="selectedYear" id="yearCtrl"  (ngModelChange)="paymentFilter('first',$event)" >
								<mat-option value="2018">2018-2019</mat-option>
								<mat-option value="2019">2019-2020</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total Count:{{firstPaymentChallanData?.length}}</h5></b></tr>
						<tr>
							<th>Student Name</th>
							<th>Student Email</th>
							<th>Course Name</th>
							<th>Challan No.</th>
							<th>Application ID</th>
							<th>Payment Date</th>
							<th>New Application ID</th>
							<th>Download</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let data of firstPaymentChallanData | paginate: { itemsPerPage: 10, currentPage: p8, id:'8' } | filter: {id: filterText, enrollment_no: filterText, stu_name: filterText } ">
							<td>{{data?.stu_name}}</td>
							<td>{{data?.email}}</td>
							<td>{{data?.course}}</td>
							<td>{{data?.challan_no}}</td>
							<td>{{data?.id}}</td>
							<td>{{data?.date}}</td>
							<td>{{data?.enrollment_no}}</td>
							<td><img src="https://mu.admissiondesk.org/uiserver/front_assets/img/images.jpg"  style="height:30px; width:80px;" (click)="DownloadFistChallan(data?.user_id,data?.id,data?.downloadlink)"></td>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p8 = $event" id='8'></pagination-controls>
			</p-tabPanel>
			<p-tabPanel header="Second Challan">
				<h3>Second Payment Challan Details</h3>
				<div class="row">
					<div class="col-lg-6 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
						</mat-form-field>
					</div>
					<div class="col-lg-3 ">
						<mat-form-field>
							<mat-select placeholder="select Year"[(ngModel)]="selectedYear" name="selectedYear" id="yearCtrl"  (ngModelChange)="paymentFilter('second',$event)" >
								<mat-option value="2018">2018-2019</mat-option>
								<mat-option value="2019">2019-2020</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total Count:{{secondPaymentChallanData?.length}}</h5></b></tr>
						<tr>
							<th>Student Name</th>
							<th>Student Email</th>
							<th>Course Name</th>
							<th>Challan No.</th>
							<th>Application ID for 1st payment</th>
							<th>Application ID</th>
							<th>Payment Date</th>
							<th>New Application ID</th>
							<th>Download</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let data of secondPaymentChallanData | paginate: { itemsPerPage: 10, currentPage: p9, id:'9' }" >
							<td>{{data?.stu_name}}</td>
							<td>{{data?.email}}</td>
							<td>{{data?.course}}</td>
							<td>{{data?.challan_no}}</td>
							<td>{{data?.user_id}}</td>
							<td>{{data?.id}}</td>
							<td>{{data?.date}}</td>
							<td>{{data?.enrollment_no}}</td>
							<td>
								<div *ngIf="data.amount == 82915.00">
									<img src="https://mu.admissiondesk.org/uiserver/front_assets/img/images.jpg" (click)="DownloadSecondChallan(data?.downloadlink)"  style="height:30px; width:80px;">
								</div>
								<div *ngIf="data.amount == 40000.00">
									<img src="https://mu.admissiondesk.org/uiserver/front_assets/img/images.jpg" (click)="DownloadSecondChallan(data?.downloadlink)"  style="height:30px; width:80px;">
								</div>
								<div *ngIf="data.amount == 42915.00">
									<img src="https://mu.admissiondesk.org/uiserver/front_assets/img/images.jpg" (click)="DownloadSecondChallan(data?.downloadlink2)"  style="height:30px; width:80px;">
								</div>
							</td>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p9 = $event" id='9'></pagination-controls>
			</p-tabPanel>
			<p-tabPanel header="College Attended">
				<h3>College Attended Student</h3>
				<div class="row">
					<div class="col-md-12 ">
						<mat-form-field class="example-full-width">
							<input matInput  type="text" [value]="filterText"
							[placeholder]="filterPlaceholder" [formControl]="filterInput" />
						</mat-form-field>
					</div>
				</div>
				<table class="table table-striped w-auto">
					<thead>
						<tr><b><h5>Total Count:{{collegeAttendedStudents?.length}}</h5></b></tr>
						<tr>
							<th>Firm letter Sent Date</th>
							<th>Student Name</th>
							<th>Student Email</th>
							<th>College Allocated</th>
							<th>Course Name</th>
							<th>College Status</th>
						</tr>
					</thead>
					<tbody>
						<tr class="info" *ngFor="let data of collegeAttendedStudents | paginate: { itemsPerPage: 10, currentPage: p10 , id:'10' } | filter:{date: filterText, stu_name: filterText, email: filterText, college_allocated: filterText, course: filterText, specialization: filterText, institute_flag: filterText }">
							<td>{{data?.date}}</td>
							<td>{{data?.stu_name}}</td>
							<td>{{data?.email}}</td>
							<td>{{data?.college_allocated}}</td>
							<td>{{data?.course}}{{data?.specialization}}</td>
							<div *ngIf="data?.institute_flag == ''">
								<td>: Pending</td>
							</div>
							<div *ngIf="data?.institute_flag != ''">
								<td>{{data?.institute_flag}}</td>
							</div>
						</tr>
					</tbody>
				</table>
				<pagination-controls (pageChange)="p10 = $event" id='10'></pagination-controls>
			</p-tabPanel>
			<p-tabPanel header="SMS Activity">
				<div [nbSpinner]="loadingbutton" nbSpinnerStatus="primary">
					<h3>SMS Activity</h3>
					<br>
					<h5 style="color: red">Note :- Data last updated on {{ yesterday }}-{{ month }}-{{ year }}  11:59:59</h5>
					<mat-form-field>
						<input matInput [matDatepicker]="picker" placeholder="Choose a month and year" [formControl]="date">
						<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
						<mat-datepicker #picker (monthSelected)="monthSelectedSMS($event)" startView="multi-year"></mat-datepicker>
					</mat-form-field>
					<div *ngIf="smsshow == 1">
						<div class="col-md-8">
							<mat-form-field class="example-full-width">
								<input matInput  type="text" [value]="filterText"
								[placeholder]="filterPlaceholder" [formControl]="filterInput" />
								<button mat-button *ngIf="filterText" matSuffix mat-icon-button aria-label="Clear" (click)="filterText=''">
									<mat-icon>close</mat-icon>
								</button>
							</mat-form-field>
						</div>
						<table class="table table-striped w-auto">
							<thead>
								<h5><b>Total Count:</b></h5>{{smsActivityData?.length}}
								<tr>
									<th>Mobile No.</th>
									<th>Message</th>
									<th>SentDate</th>
									<th>Status</th>
									<th>Error</th>
								</tr>
							</thead>
							<tbody>
								<tr class="info" *ngFor="let sms of smsActivityData | filter:{to:filterText,errorMessage:filterText,msg:filterText,date:filterText,status:filterText} | paginate: { itemsPerPage: 10, currentPage: p }">
									<td>{{sms.to}}</td>
									<td>{{sms.body}}</td>
									<td>{{sms.dateSent}}</td>
									<td>{{sms.status}}</td>
									<td>{{sms.errorMessage}}</td>
								</tr>
							</tbody>	
						</table>
						<pagination-controls (pageChange)="p = $event"></pagination-controls>
					</div>
				</div>
			</p-tabPanel>
		</p-tabView>    
	</nb-card-body>
</nb-card>
	